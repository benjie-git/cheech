<refentry id="gnet-ipv6">
<refmeta>
<refentrytitle role="top_of_page">IPv6</refentrytitle>
<manvolnum>3</manvolnum>
<refmiscinfo>GNET Library</refmiscinfo>
</refmeta>

<refnamediv>
<refname>IPv6</refname>
<refpurpose>IPv6 policy functions</refpurpose>
<!--[<xref linkend="desc" endterm="desc.title"/>]-->
</refnamediv>

<refsynopsisdiv role="synopsis">
<title role="synopsis.title">Synopsis</title>

<synopsis>

#include &lt;gnet.h&gt;


enum                <link linkend="GIPv6Policy">GIPv6Policy</link>;
<link linkend="void">void</link>                <link linkend="gnet-ipv6-set-policy">gnet_ipv6_set_policy</link>                (<link linkend="GIPv6Policy">GIPv6Policy</link> policy);
<link linkend="GIPv6Policy">GIPv6Policy</link>         <link linkend="gnet-ipv6-get-policy">gnet_ipv6_get_policy</link>                (void);
</synopsis>
</refsynopsisdiv>









<refsect1 role="desc">
<title role="desc.title">Description</title>
<para>
The IPv6 module provides functions for setting and getting the "IPv6
policy".  The IPv6 policy affects domain name resolution and server
binding.  The possible policies are: IPv4 only, IPv6 only, IPv4 then
IPv6, and IPv6 then IPv4.  GNet attempts to set the policy when
<link linkend="gnet-init"><function>gnet_init()</function></link> is called based on two environment variables (if set) or
on the host's interfaces.  This can be overridden by calling
<link linkend="gnet-ipv6-set-policy"><function>gnet_ipv6_set_policy()</function></link>.
</para>

<para>
IPv6 policy affects domain name resolution.  A domain name can be
resolved to several addresses.  Most programs will only use the first
address in the list.  The problem then is what order the addresses
should be in.  For example, if there are both IPv4 and IPv6 addresses
in the list and the system cannot connect to IPv6 hosts then an IPv6
address should not be first in the list.  Otherwise, the host will
attempt to connect to it and fail.  IPv6 policy determines the order
of the list.  If the policy is "IPv4 only", only IPv4 addresses will
be returned.  If the policy is "IPv6 then IPv4", IPv6 addresses will
come before IPv4 addresses in the list.
</para>

<para>
IPv6 policy also affects server binding.  When a server socket is
created, GNet binds to the "any" address by default.  There are IPv4
and IPv6 "any" addresses.  GNet needs to know which one to use.  If
the IPv6 policy allows IPv6, GNet will use the IPv6 "any" address.  If
the IPv6 policy allows only IPv4, GNet will use the IPv4 "any"
address.
</para>

<para>
GNet sets IPv6 policy in <link linkend="gnet-init"><function>gnet_init()</function></link>.  First it checks two environment
variables: GNET_IPV6_POLICY and IPV6_POLICY.  If either is set, it
uses the value to set IPv6 policy.  Set the value to "4" for
<link linkend="GIPV6-POLICY-IPV4-ONLY:CAPS"><literal>GIPV6_POLICY_IPV4_ONLY</literal></link>, "6" for <link linkend="GIPV6-POLICY-IPV6-ONLY:CAPS"><literal>GIPV6_POLICY_IPV6_ONLY</literal></link>, "46" for
<link linkend="GIPV6-POLICY-IPV4-THEN-IPV6:CAPS"><literal>GIPV6_POLICY_IPV4_THEN_IPV6</literal></link>, or "64" for
<link linkend="GIPV6-POLICY-IPV6-THEN-IPV4:CAPS"><literal>GIPV6_POLICY_IPV6_THEN_IPV4</literal></link>.
</para>

<para>
If neither environment variable is set, GNet sets the policy based on
the host's interfaces.  If there are only IPv4 interfaces, the policy
is set to <link linkend="GIPV6-POLICY-IPV4-ONLY:CAPS"><literal>GIPV6_POLICY_IPV4_ONLY</literal></link>.  If there are only IPv6 interfaces,
the policy is set to <link linkend="GIPV6-POLICY-IPV6-ONLY:CAPS"><literal>GIPV6_POLICY_IPV6_ONLY</literal></link>.  If there are both, the
policy is set to <link linkend="GIPV6-POLICY-IPV4-THEN-IPV6:CAPS"><literal>GIPV6_POLICY_IPV4_THEN_IPV6</literal></link>.
</para>

<para>
At runtime on Windows, GNet will check to see the computer can support
IPv6. If so it will set the policy to <link linkend="GIPV6-POLICY-IPV4-THEN-IPV6:CAPS"><literal>GIPV6_POLICY_IPV4_THEN_IPV6</literal></link>. If
not it will set the policy to <link linkend="GIPV6-POLICY-IPV4-ONLY:CAPS"><literal>GIPV6_POLICY_IPV4_ONLY</literal></link>. Environment 
variables are not checked on Windows.
</para>
</refsect1>

<refsect1 role="details">
<title role="details.title">Details</title>
<refsect2>
<title><anchor id="GIPv6Policy" role="enum"/>enum GIPv6Policy</title>
<indexterm><primary>GIPv6Policy</primary></indexterm><programlisting>typedef enum {
  GIPV6_POLICY_IPV4_THEN_IPV6,
  GIPV6_POLICY_IPV6_THEN_IPV4,
  GIPV6_POLICY_IPV4_ONLY,
  GIPV6_POLICY_IPV6_ONLY
} GIPv6Policy;
</programlisting>
<para>
Policy for IPv6 use in GNet.  This affects domain name resolution
 and server binding.  <link linkend="gnet-init"><function>gnet_init()</function></link> attempts to set a reasonable
 default based on environment variables or the interfaces available
 on the host.</para>
<para>

</para><variablelist role="enum">
<varlistentry>
<term><anchor id="GIPV6-POLICY-IPV4-THEN-IPV6:CAPS" role="constant"/><literal>GIPV6_POLICY_IPV4_THEN_IPV6</literal></term>
<listitem><simpara> Use IPv4, then IPv6
</simpara></listitem>
</varlistentry>
<varlistentry>
<term><anchor id="GIPV6-POLICY-IPV6-THEN-IPV4:CAPS" role="constant"/><literal>GIPV6_POLICY_IPV6_THEN_IPV4</literal></term>
<listitem><simpara> Use IPv6, then IPv4
</simpara></listitem>
</varlistentry>
<varlistentry>
<term><anchor id="GIPV6-POLICY-IPV4-ONLY:CAPS" role="constant"/><literal>GIPV6_POLICY_IPV4_ONLY</literal></term>
<listitem><simpara> Use IPv4 only
</simpara></listitem>
</varlistentry>
<varlistentry>
<term><anchor id="GIPV6-POLICY-IPV6-ONLY:CAPS" role="constant"/><literal>GIPV6_POLICY_IPV6_ONLY</literal></term>
<listitem><simpara> Use IPv6 only
</simpara></listitem>
</varlistentry>
</variablelist></refsect2>
<refsect2>
<title><anchor id="gnet-ipv6-set-policy" role="function"/>gnet_ipv6_set_policy ()</title>
<indexterm><primary>gnet_ipv6_set_policy</primary></indexterm><programlisting><link linkend="void">void</link>                gnet_ipv6_set_policy                (<link linkend="GIPv6Policy">GIPv6Policy</link> policy);</programlisting>
<para>
Sets the IPv6 policy.</para>
<para>

</para><variablelist role="params">
<varlistentry><term><parameter>policy</parameter>&nbsp;:</term>
<listitem><simpara> IPv6 policy
</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2>
<title><anchor id="gnet-ipv6-get-policy" role="function"/>gnet_ipv6_get_policy ()</title>
<indexterm><primary>gnet_ipv6_get_policy</primary></indexterm><programlisting><link linkend="GIPv6Policy">GIPv6Policy</link>         gnet_ipv6_get_policy                (void);</programlisting>
<para>
Gets the IPv6 policy.</para>
<para>

</para><variablelist role="params">
<varlistentry><term><emphasis>Returns</emphasis>&nbsp;:</term><listitem><simpara> IPv6 policy.
</simpara></listitem></varlistentry>
</variablelist></refsect2>

</refsect1>




</refentry>
